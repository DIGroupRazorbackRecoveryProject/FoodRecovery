<!-- templates/volunteerSignUp.html -->
<h1 class="title">Volunteer Sign Up</h1>
<div style="display: flex; align-items: center; margin-bottom: 10px;">
  <img src="/FoodRecovery/icons/profile.png" alt="Profile Icon" class="profile-icon" style="width: 100px; height: 100px;">
  <div>
    <h2 class="subtitle-volunteer">Welcome Volunteer</h2>
    <p class="subtitle-text">Join us in making a difference</p>
  </div>
</div>
<form id="volunteer-signup">
  <div class="form-group">
    <label for="firstname-input">First Name</label>
    <input type="text" class="form-control" id="firstname-input" placeholder="Enter your firstname" required>
  </div>

  <div class="form-group">
    <label for="lastname-input">Last Name</label>
    <input type="text" class="form-control" id="lastname-input" placeholder="Enter your lastname">
  </div>

  <div class="form-group">
    <label for="email-input">Email Address</label>
    <input type="email" class="form-control" id="email-input" placeholder="Enter your email address" required>
  </div>

  <div class="form-group">
    <label for="password-input">Password</label>
    <input type="password" class="form-control" id="password-input" placeholder="Enter your password" required>
  </div>

  <div class="form-group">
    <label for="confirmpassword-input">Confirm Password</label>
    <input type="password" class="form-control" id="confirmpassword-input" placeholder="Confirm your password" required>
  </div>

  <div class="form-group">
    <label for="phone-input">Phone Number</label>
    <input type="tel" class="form-control" id="phone-input" placeholder="Enter your phone number" required>
  </div>

  <button type="submit" class="btn btn-primary" id="signup-button">Sign Up</button>
</form>

<script type="module">
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  const auth = getAuth();
  const db = getFirestore();
  $('#signup-button').click(function(event) {
    event.preventDefault();
    const firstName = $('#firstname-input').val();
    const lastName = $('#lastname-input').val();
    const email = $('#email-input').val();
    const password = $('#password-input').val();
    const confirmPassword = $('#confirmpassword-input').val();
    const phone = $('#phone-input').val();

    if (password !== confirmPassword) {
      alert('Passwords do not match.');
      return;
    }

    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        const user = userCredential.user;
        const userData = {
          firstName: firstName,
          lastName: lastName,
          email: email,
          phone: phone
        };

        console.log('User ID:', user.uid);
        console.log('User Data:', userData);
        // Save user data to Firestore in the UserProfile collection
        setDoc(doc(db, 'UserProfile', user.uid), userData)
          .then(() => {
            console.log('User data saved successfully.');
            localStorage.setItem('loggedIn', true);
            loadContent('volunteerdashboard');
          })
          .catch((error) => {
            console.error('Error saving user data:', error);
            alert('Error saving user data.');
          });
      })
      .catch((error) => {
        console.error('Error during signup:', error);
        alert('Error signing up.');
      });
  });
</script>
